<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê²°ì œ - TechFlow</title>
    <link rel="stylesheet" href="styles.css">
    <!-- Mixpanel -->
    <script type="text/javascript">
        (function(e,c){if(!c.__SV){var l,h;window.mixpanel=c;c._i=[];c.init=function(q,r,f){function t(d,a){var g=a.split(".");2==g.length&&(d=d[g[0]],a=g[1]);d[a]=function(){d.push([a].concat(Array.prototype.slice.call(arguments,0)))}}var b=c;"undefined"!==typeof f?b=c[f]=[]:f="mixpanel";b.people=b.people||[];b.toString=function(d){var a="mixpanel";"mixpanel"!==f&&(a+="."+f);d||(a+=" (stub)");return a};b.people.toString=function(){return b.toString(1)+".people (stub)"};l="disable time_event track track_pageview track_links track_forms track_with_groups add_group set_group remove_group register register_once alias unregister identify name_tag set_config reset opt_in_tracking opt_out_tracking has_opted_in_tracking has_opted_out_tracking clear_opt_in_out_tracking start_batch_senders start_session_recording stop_session_recording people.set people.set_once people.unset people.increment people.append people.union people.track_charge people.clear_charges people.delete_user people.remove".split(" ");
        for(h=0;h<l.length;h++)t(b,l[h]);var n="set set_once union unset remove delete".split(" ");b.get_group=function(){function d(p){a[p]=function(){b.push([g,[p].concat(Array.prototype.slice.call(arguments,0))])}}for(var a={},g=["get_group"].concat(Array.prototype.slice.call(arguments,0)),m=0;m<n.length;m++)d(n[m]);return a};c._i.push([q,r,f])};c.__SV=1.2;var k=e.createElement("script");k.type="text/javascript";k.async=!0;k.src="undefined"!==typeof MIXPANEL_CUSTOM_LIB_URL?MIXPANEL_CUSTOM_LIB_URL:"file:"===
        e.location.protocol&&"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js".match(/^\/\//)?"https://cdn.mxpnl.com/libs/mixpanel-2-latest.min.js":"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js";e=e.getElementsByTagName("script")[0];e.parentNode.insertBefore(k,e)}})(document,window.mixpanel||[])

        mixpanel.init('25ae0cf24ebef4cca92200d7ecb3dadb', {
            autocapture: true,
            record_sessions_percent: 100,
        })
    </script>
    <script>
        // AARRR Revenue ì´ë²¤íŠ¸
        const AARRR = {
            trackRevenue: function(plan, amount, currency) {
                mixpanel.track('Revenue', {
                    plan: plan,
                    amount: amount,
                    currency: currency || 'KRW',
                    transaction_id: 'TXN_' + Date.now(),
                    funnel_stage: 'revenue'
                });
                mixpanel.people.track_charge(amount);
                mixpanel.people.set({
                    'plan': plan,
                    'last_purchase_date': new Date().toISOString()
                });
                console.log('ğŸ’° [Revenue] ê²°ì œ ì™„ë£Œ:', plan, amount + 'ì›');
            },
            trackCheckoutStep: function(step, details) {
                mixpanel.track('Checkout Step', {
                    step_name: step,
                    funnel_stage: 'revenue',
                    ...details
                });
                console.log('ğŸ›’ [Checkout]', step, details || '');
            }
        };

        // í”Œëœ ì •ë³´
        const plans = {
            'free': { name: 'Free', price: 0, period: 'ì›”' },
            'pro': { name: 'Pro', price: 15000, period: 'ì›”' },
            'enterprise': { name: 'Enterprise', price: 50000, period: 'ì›”' }
        };

        // í˜ì´ì§€ ë¡œë“œ ì‹œ í”Œëœ í™•ì¸
        document.addEventListener('DOMContentLoaded', function() {
            const urlParams = new URLSearchParams(window.location.search);
            const planId = urlParams.get('plan') || 'pro';
            const plan = plans[planId] || plans['pro'];

            document.getElementById('planName').textContent = plan.name + ' í”Œëœ';
            document.getElementById('planPrice').textContent = 'â‚©' + plan.price.toLocaleString();
            document.getElementById('planTotal').textContent = 'â‚©' + plan.price.toLocaleString();

            // Mixpanel ì²´í¬ì•„ì›ƒ ì‹œì‘ ì´ë²¤íŠ¸
            mixpanel.track('Begin Checkout', {
                plan: planId,
                amount: plan.price,
                currency: 'KRW',
                funnel_stage: 'revenue'
            });

            AARRR.trackCheckoutStep('checkout_start', { plan: planId, amount: plan.price });
        });
    </script>
</head>
<body>
    <div class="checkout-page">
        <nav class="navbar" style="position: relative; background: transparent; border: none;">
            <div class="nav-container">
                <a href="index.html" class="logo">
                    <span class="logo-icon">âš¡</span>
                    TechFlow
                </a>
                <a href="dashboard.html" class="btn btn-outline">â† ëŒ€ì‹œë³´ë“œë¡œ</a>
            </div>
        </nav>

        <div class="checkout-container">
            <div class="checkout-card">
                <div class="checkout-header">
                    <h1>ğŸ‰ ê²°ì œ í˜ì´ì§€</h1>
                    <p>ì—…ê·¸ë ˆì´ë“œí•˜ê³  ë” ë§ì€ ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ì„¸ìš”</p>
                </div>

                <div class="checkout-body">
                    <!-- í”Œëœ ìš”ì•½ -->
                    <div class="plan-summary">
                        <h3>ì£¼ë¬¸ ìš”ì•½</h3>
                        <div class="plan-detail">
                            <span id="planName">Pro í”Œëœ</span>
                            <span id="planPrice">â‚©15,000</span>
                        </div>
                        <div class="plan-detail">
                            <span>ê²°ì œ ì£¼ê¸°</span>
                            <span>ì›”ê°„</span>
                        </div>
                        <div class="plan-detail">
                            <span>í•©ê³„</span>
                            <span id="planTotal">â‚©15,000</span>
                        </div>
                    </div>

                    <!-- ê²°ì œ í¼ -->
                    <form id="checkoutForm" onsubmit="handlePayment(event)">
                        <div class="form-group">
                            <label>ì¹´ë“œ ë²ˆí˜¸</label>
                            <input type="text" placeholder="1234 5678 9012 3456" required
                                   onfocus="AARRR.trackCheckoutStep('card_number_focus')">
                        </div>

                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                            <div class="form-group">
                                <label>ë§Œë£Œì¼</label>
                                <input type="text" placeholder="MM/YY" required
                                       onfocus="AARRR.trackCheckoutStep('expiry_focus')">
                            </div>
                            <div class="form-group">
                                <label>CVC</label>
                                <input type="text" placeholder="123" required
                                       onfocus="AARRR.trackCheckoutStep('cvc_focus')">
                            </div>
                        </div>

                        <div class="form-group">
                            <label>ì¹´ë“œ ì†Œìœ ìëª…</label>
                            <input type="text" placeholder="í™ê¸¸ë™" required
                                   onfocus="AARRR.trackCheckoutStep('cardholder_focus')">
                        </div>

                        <button type="submit" class="btn btn-primary btn-large" style="width: 100%; margin-top: 24px;">
                            ğŸ’³ ê²°ì œí•˜ê¸°
                        </button>
                    </form>

                    <div style="margin-top: 24px; text-align: center;">
                        <p style="font-size: 13px; color: var(--gray-400);">
                            ğŸ”’ SSL ì•”í˜¸í™”ë¡œ ì•ˆì „í•˜ê²Œ ê²°ì œë©ë‹ˆë‹¤
                        </p>
                        <div style="margin-top: 12px; display: flex; justify-content: center; gap: 12px;">
                            <span style="padding: 4px 8px; background: var(--gray-100); border-radius: 4px; font-size: 12px;">VISA</span>
                            <span style="padding: 4px 8px; background: var(--gray-100); border-radius: 4px; font-size: 12px;">Mastercard</span>
                            <span style="padding: 4px 8px; background: var(--gray-100); border-radius: 4px; font-size: 12px;">AMEX</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ë³´ì¥ ë¬¸êµ¬ -->
            <div style="margin-top: 24px; text-align: center; color: var(--gray-600);">
                <p>âœ“ 30ì¼ í™˜ë¶ˆ ë³´ì¥ &nbsp; âœ“ ì–¸ì œë“  ì·¨ì†Œ ê°€ëŠ¥ &nbsp; âœ“ 24ì‹œê°„ ê³ ê° ì§€ì›</p>
            </div>
        </div>
    </div>

    <script>
        function handlePayment(e) {
            e.preventDefault();

            const urlParams = new URLSearchParams(window.location.search);
            const planId = urlParams.get('plan') || 'pro';
            const plan = plans[planId] || plans['pro'];

            // Mixpanel êµ¬ë§¤ ì™„ë£Œ ì´ë²¤íŠ¸
            AARRR.trackRevenue(plan.name, plan.price, 'KRW');

            AARRR.trackCheckoutStep('payment_complete', {
                plan: planId,
                amount: plan.price
            });

            // ì„±ê³µ ë©”ì‹œì§€
            alert('ğŸ‰ ê²°ì œê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!\n\n' + plan.name + ' í”Œëœì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
            window.location.href = 'dashboard.html';
        }

        // ê°œë°œì ì½˜ì†” ì•ˆë‚´
        console.log('%cğŸ“ Mixpanel AARRR í¼ë„ ë¶„ì„ ë°ëª¨ - ê²°ì œ í˜ì´ì§€', 'font-size: 20px; font-weight: bold; color: #6366f1;');
        console.log('%cì´ í˜ì´ì§€ì—ì„œ ë°œìƒí•˜ëŠ” Revenue ì´ë²¤íŠ¸ë¥¼ í™•ì¸í•˜ì„¸ìš”:', 'font-size: 14px; color: #666;');
        console.log('%câ€¢ ğŸ’° Revenue: ê²°ì œ ì™„ë£Œ ì‹œ purchase ì´ë²¤íŠ¸', 'font-size: 12px;');
        console.log('%câ€¢ ğŸ›’ Checkout: ê° ì…ë ¥ í•„ë“œ í¬ì»¤ìŠ¤ ì‹œ í¼ë„ ì¶”ì ', 'font-size: 12px;');
        console.log('---');
    </script>
</body>
</html>
